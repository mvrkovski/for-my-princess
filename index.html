<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Knight Quest</title>
<style>
    body { margin:0; overflow:hidden; font-family:"Georgia", serif; background:#d8c7a1; }
    .scene { display:none; width:100vw; height:100vh; position:relative; }
    .scene.active { display:block; }
    #scene1, #scene2, #scene3 { background-size: cover; background-position: center; }
    
    img.character { position:absolute; bottom:20px; width:120px; height:auto; cursor:pointer; }
    #popup { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
        background:#fff; border:4px solid #000; padding:20px; text-align:center; z-index:999; }
    #popup img { width:200px; }
    .btn { margin-top:10px; padding:8px 14px; border:2px solid black; background:#e0d5bd; cursor:pointer; }
</style>
</head>
<body>

<!-- Сцена 1: Деревня -->
<div id="scene1" class="scene active" style="background-image: url('images/vil.jpg');">
    <img id="knight1" class="character" src="images/k.png">
    <img id="letter" class="character" src="images/cс.png" style="left:300px;">
</div>

<!-- Сцена 2: Дорога -->
<div id="scene2" class="scene" style="background-image: url('images/road.jpeg');">
    <img id="knight2" class="character" src="images/k.png" style="left:20px;">
</div>

<!-- Сцена 3: Замок -->
<div id="scene3" class="scene" style="background-image: url('images/cas.webp');">
    <img id="knight3" class="character" src="images/k.png" style="left:20px;">
    <img id="princess" class="character" src="images/p.png" style="right:50px; bottom:20px;">
    <div id="popup">
        <h2>✨ Рыцарь доставил письмо принцессе! ✨</h2>
        <p>Вот что там было:</p>
        <img src="images/qr.png" alt="QR">
        <div class="btn" onclick="location.reload()">Играть снова</div>
    </div>
</div>

<!-- Музыка -->
<audio id="music" src="music/Golden_Brown__Slowed_Down_Version_128k.mp3" loop></audio>

<script>
    // Сцены
const scenes = document.querySelectorAll(".scene");
function goToScene(n) {
    scenes.forEach(s => s.classList.remove("active"));
    document.getElementById("scene" + n).classList.add("active");
}

// Музыка
document.addEventListener("keydown", () => {
    const m = document.getElementById("music");
    if (m.paused) m.play();
});

// Сцена 1: подбор письма
document.getElementById("letter").addEventListener("click", () => {
    alert("Рыцарь забрал письмо! В путь к замку!");
    goToScene(2);
});

// Сцена 2: движение рыцаря клавишами
let knightPos = 20; // позиция рыцаря
let questionAsked = false; // флаг загадки

const knight2 = document.getElementById("knight2");

function startScene2() {
    knightPos = 20;
    questionAsked = false;
    knight2.style.left = knightPos + "px";
    goToScene(2);
}

// Движение стрелками
document.addEventListener("keydown", (e) => {
    const scene2 = document.getElementById("scene2");
    if (!scene2.classList.contains("active")) return;

    const step = 20;

    if (e.key === "ArrowRight") knightPos += step;
    if (e.key === "ArrowLeft") knightPos -= step;

    // Ограничение по краям экрана
    if (knightPos < 0) knightPos = 0;
    if (knightPos > window.innerWidth - 200) knightPos = window.innerWidth - 200;

    knight2.style.left = knightPos + "px";

    // Загадка
    if (!questionAsked && knightPos >= 300) {
        const answer = prompt("Загадка: Что попалось в киндере принцессе?");
        if (answer.toLowerCase() === "кролик") {
            alert("Правильно! Двигаемся дальше.");
        } else {
            alert("Неправильно! Попробуй ещё раз.");
        }
        questionAsked = true;
    }

    // Переход к сцене 3
    if (knightPos >= window.innerWidth - 200) {
        goToScene(3);
        setTimeout(() => {
            document.getElementById("popup").style.display = "block";
        }, 500);
    }
});

</script>

</body>
</html>
